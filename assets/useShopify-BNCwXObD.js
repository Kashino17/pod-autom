import{b as m,u as g,c as d}from"./vendor-query-CpRdniug.js";import{u as w,a as f}from"./index-CupJPaFk.js";import{a}from"./api-DNziMqA2.js";function b(){const{session:e}=w(),n=f(t=>t.addToast),r=m(),{data:p,isLoading:h,error:l,refetch:y}=g({queryKey:["pod-autom-shops"],queryFn:async()=>{const t=await a.get("/api/pod-autom/shops");if(!t.success)throw new Error("Failed to fetch shops");return t.shops},enabled:!!e}),c=d({mutationFn:async t=>{const i=await a.post("/api/pod-autom/shops",t);if(!i.success)throw new Error(i.error||"Failed to create shop");return i.shop},onSuccess:()=>{r.invalidateQueries({queryKey:["pod-autom-shops"]}),n({type:"success",title:"Shop verbunden",description:"Der Shop wurde erfolgreich verbunden."})},onError:t=>{n({type:"error",title:"Fehler",description:t.message})}}),o=d({mutationFn:async t=>{const i=await a.delete(`/api/pod-autom/shops/${t}`);if(!i.success)throw new Error(i.error||"Failed to delete shop")},onSuccess:()=>{r.invalidateQueries({queryKey:["pod-autom-shops"]}),n({type:"success",title:"Shop entfernt",description:"Der Shop wurde erfolgreich entfernt."})},onError:t=>{n({type:"error",title:"Fehler",description:t.message})}}),s=d({mutationFn:async t=>await a.post(`/api/pod-autom/shops/${t}/test`),onSuccess:t=>{r.invalidateQueries({queryKey:["pod-autom-shops"]}),t.success?n({type:"success",title:"Verbindung OK",description:"Die Shop-Verbindung funktioniert."}):n({type:"error",title:"Verbindungsfehler",description:t.error||"Die Verbindung konnte nicht hergestellt werden."})}}),u=(t,i)=>{const F="http://localhost:5001",S=t.toLowerCase().trim().replace(/^https?:\/\//,"").replace(/\/$/,"");window.location.href=`${F}/api/pod-autom/shopify/install?shop=${S}&user_id=${i}`};return{shops:p||[],isLoading:h,error:l,refetch:y,createShop:c.mutate,isCreating:c.isPending,deleteShop:o.mutate,isDeleting:o.isPending,testConnection:s.mutate,isTesting:s.isPending,startOAuthFlow:u}}function K(e){const{session:n}=w(),r=f(o=>o.addToast),p=m(),{data:h,isLoading:l,error:y}=g({queryKey:["pod-autom-settings",e],queryFn:async()=>e?(await a.get(`/api/pod-autom/settings/${e}`)).settings:null,enabled:!!n&&!!e}),c=d({mutationFn:async o=>{if(!e)throw new Error("No shop selected");const s=await a.put(`/api/pod-autom/settings/${e}`,o);if(!s.success)throw new Error(s.error||"Failed to update settings");return s.settings},onSuccess:()=>{p.invalidateQueries({queryKey:["pod-autom-settings",e]}),r({type:"success",title:"Einstellungen gespeichert"})},onError:o=>{r({type:"error",title:"Fehler",description:o.message})}});return{settings:h,isLoading:l,error:y,updateSettings:c.mutate,isUpdating:c.isPending}}function N(e){const{session:n}=w(),r=f(s=>s.addToast),p=m(),{data:h,isLoading:l,error:y}=g({queryKey:["pod-autom-niches",e],queryFn:async()=>e?(await a.get(`/api/pod-autom/niches/${e}`)).niches:[],enabled:!!n&&!!e}),c=d({mutationFn:async s=>{if(!e)throw new Error("No settings selected");const u=await a.post(`/api/pod-autom/niches/${e}`,{niche_name:s});if(!u.success)throw new Error(u.error||"Failed to create niche");return u.niche},onSuccess:()=>{p.invalidateQueries({queryKey:["pod-autom-niches",e]}),r({type:"success",title:"Nische hinzugefuegt"})},onError:s=>{r({type:"error",title:"Fehler",description:s.message})}}),o=d({mutationFn:async s=>{if(!e)throw new Error("No settings selected");const u=await a.delete(`/api/pod-autom/niches/${e}/${s}`);if(!u.success)throw new Error(u.error||"Failed to delete niche")},onSuccess:()=>{p.invalidateQueries({queryKey:["pod-autom-niches",e]}),r({type:"success",title:"Nische entfernt"})},onError:s=>{r({type:"error",title:"Fehler",description:s.message})}});return{niches:h||[],isLoading:l,error:y,createNiche:c.mutate,isCreating:c.isPending,deleteNiche:o.mutate,isDeleting:o.isPending}}export{K as a,N as b,b as u};
//# sourceMappingURL=useShopify-BNCwXObD.js.map

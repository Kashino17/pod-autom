import{b as V,u as S,c as v,j as e}from"./vendor-query-CpRdniug.js";import{r as g,L as M}from"./vendor-react-4xEIaAEA.js";import{d as q}from"./index-DMzOI_GZ.js";import{u as Q}from"./useShopify-D96WEgLm.js";import{D as E}from"./DashboardLayout-CmF7xzGu.js";import{a as j}from"./api-DZjOEeDy.js";import{u as U}from"./usePinterest-DC43FXi5.js";import{L as k,M as C,R as B,J as z,O as K,D,e as O,F as H,T as W,K as J,N as X,Q as A,s as Z,a7 as G,t as Y,X as I}from"./vendor-ui-BMWb517o.js";import"./vendor-supabase-DejIJ_qE.js";import"./vendor-charts-Cz_1NfFu.js";function ee(s){const a=V(),n=S({queryKey:["campaigns",s],queryFn:()=>j.get(`/api/pod-autom/campaigns/${s}`),enabled:!!s,staleTime:1e3*60*2}),r=S({queryKey:["campaigns","sync-log",s],queryFn:()=>j.get(`/api/pod-autom/campaigns/${s}/sync-log`),enabled:!!s,staleTime:1e3*60*2}),t=v({mutationFn:l=>j.post(`/api/pod-autom/campaigns/${s}`,l),onSuccess:()=>{a.invalidateQueries({queryKey:["campaigns",s]})}}),c=v({mutationFn:({campaignId:l,data:f})=>j.put(`/api/pod-autom/campaigns/${s}/${l}`,f),onSuccess:()=>{a.invalidateQueries({queryKey:["campaigns",s]})}}),x=v({mutationFn:({campaignId:l,status:f})=>j.post(`/api/pod-autom/campaigns/${s}/${l}/status`,{status:f}),onSuccess:()=>{a.invalidateQueries({queryKey:["campaigns",s]})}}),d=v({mutationFn:l=>j.delete(`/api/pod-autom/campaigns/${s}/${l}`),onSuccess:()=>{a.invalidateQueries({queryKey:["campaigns",s]})}}),i=n.data?.campaigns??[],u=n.data?.stats??{total_campaigns:0,active_campaigns:0,paused_campaigns:0,total_spend:0,total_conversions:0,avg_roas:0},h=r.data?.logs??[],p=i.filter(l=>l.status==="ACTIVE"),b=i.filter(l=>l.status==="PAUSED"),o=i.filter(l=>l.status==="DRAFT");return{campaigns:i,activeCampaigns:p,pausedCampaigns:b,draftCampaigns:o,stats:u,syncLog:h,isLoading:n.isLoading,isSyncLogLoading:r.isLoading,error:n.error,createCampaign:t.mutate,createCampaignAsync:t.mutateAsync,isCreating:t.isPending,updateCampaign:c.mutate,isUpdating:c.isPending,updateStatus:x.mutate,isUpdatingStatus:x.isPending,deleteCampaign:d.mutate,isDeleting:d.isPending,refetch:()=>{a.invalidateQueries({queryKey:["campaigns",s]})},refetchSyncLog:()=>{a.invalidateQueries({queryKey:["campaigns","sync-log",s]})}}}function y({title:s,value:a,icon:n,color:r="violet"}){const t={violet:"bg-violet-500/20 text-violet-400",emerald:"bg-emerald-500/20 text-emerald-400",amber:"bg-amber-500/20 text-amber-400",red:"bg-red-500/20 text-red-400"};return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-zinc-400",children:s}),e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${t[r]}`,children:n})]}),e.jsx("span",{className:"text-2xl font-bold text-white",children:a})]})}function se({campaign:s,onStatusChange:a,onDelete:n,isUpdating:r}){const[t,c]=g.useState(!1),x={ACTIVE:"bg-emerald-500/20 text-emerald-400",PAUSED:"bg-amber-500/20 text-amber-400",DRAFT:"bg-zinc-700 text-zinc-400",ARCHIVED:"bg-zinc-800 text-zinc-500",ERROR:"bg-red-500/20 text-red-400"},d=u=>new Intl.NumberFormat("de-DE",{style:"currency",currency:s.currency||"EUR"}).format(u),i=u=>new Intl.NumberFormat("de-DE").format(u);return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 hover:border-zinc-700 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-white truncate",children:s.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${x[s.status]}`,children:s.status})]}),e.jsxs("p",{className:"text-sm text-zinc-500",children:[s.platform.charAt(0).toUpperCase()+s.platform.slice(1)," |"," ",s.campaign_type==="winner_scaling"?"Winner":"Standard"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!t),className:"p-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white transition-colors",children:e.jsx(J,{className:"w-4 h-4"})}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-zinc-800 border border-zinc-700 rounded-lg shadow-xl z-20 py-1",children:[s.status==="ACTIVE"&&e.jsxs("button",{onClick:()=>{a(s.id,"PAUSED"),c(!1)},disabled:r,className:"w-full px-3 py-2 text-left text-sm text-zinc-300 hover:bg-zinc-700 flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),"Pausieren"]}),s.status==="PAUSED"&&e.jsxs("button",{onClick:()=>{a(s.id,"ACTIVE"),c(!1)},disabled:r,className:"w-full px-3 py-2 text-left text-sm text-zinc-300 hover:bg-zinc-700 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Aktivieren"]}),s.status!=="ARCHIVED"&&e.jsxs("button",{onClick:()=>{a(s.id,"ARCHIVED"),c(!1)},disabled:r,className:"w-full px-3 py-2 text-left text-sm text-zinc-300 hover:bg-zinc-700 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Archivieren"]}),e.jsxs("button",{onClick:()=>{confirm("Kampagne wirklich loeschen?")&&n(s.id),c(!1)},disabled:r,className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-zinc-700 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Loeschen"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-zinc-500 text-xs mb-1",children:[e.jsx(D,{className:"w-3 h-3"}),"Ausgaben"]}),e.jsx("p",{className:"text-sm font-medium text-white",children:d(s.total_spend)})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-zinc-500 text-xs mb-1",children:[e.jsx(Z,{className:"w-3 h-3"}),"Impressionen"]}),e.jsx("p",{className:"text-sm font-medium text-white",children:i(s.total_impressions)})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-zinc-500 text-xs mb-1",children:[e.jsx(G,{className:"w-3 h-3"}),"Klicks"]}),e.jsx("p",{className:"text-sm font-medium text-white",children:i(s.total_clicks)})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-zinc-500 text-xs mb-1",children:[e.jsx(Y,{className:"w-3 h-3"}),"Conversions"]}),e.jsx("p",{className:"text-sm font-medium text-white",children:i(s.total_conversions)})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-zinc-500",children:["Budget: ",e.jsxs("span",{className:"text-white",children:[d(s.daily_budget),"/Tag"]})]}),s.roas!==null&&s.roas>0&&e.jsxs("span",{className:"text-zinc-500",children:["ROAS: ",e.jsxs("span",{className:"text-emerald-400",children:[s.roas.toFixed(2),"x"]})]})]}),e.jsx("span",{className:"text-xs text-zinc-600",children:s.last_sync_at?`Sync: ${new Date(s.last_sync_at).toLocaleDateString("de-DE")}`:"Nie synchronisiert"})]})]})}function te({isOpen:s,onClose:a,onCreate:n,isCreating:r}){const[t,c]=g.useState(""),[x,d]=g.useState(""),[i,u]=g.useState("10.00"),[h,p]=g.useState("standard");if(!s)return null;const b=o=>{o.preventDefault(),t.trim()&&n({name:t.trim(),description:x.trim()||void 0,daily_budget:parseFloat(i),campaign_type:h,status:"DRAFT"})};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:a}),e.jsxs("div",{className:"relative w-full max-w-lg bg-zinc-900 border border-zinc-800 rounded-2xl shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Neue Kampagne erstellen"}),e.jsx("button",{onClick:a,className:"p-1 text-zinc-400 hover:text-white",children:e.jsx(I,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:b,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"Kampagnen-Name *"}),e.jsx("input",{type:"text",value:t,onChange:o=>c(o.target.value),placeholder:"z.B. Sommer Kollektion 2026",className:"input w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"Beschreibung"}),e.jsx("textarea",{value:x,onChange:o=>d(o.target.value),placeholder:"Optionale Beschreibung...",className:"input w-full h-20 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"Tagesbudget (EUR)"}),e.jsx("input",{type:"number",value:i,onChange:o=>u(o.target.value),min:"1",step:"0.01",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-300 mb-1",children:"Kampagnen-Typ"}),e.jsxs("select",{value:h,onChange:o=>p(o.target.value),className:"input w-full",children:[e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"collection",children:"Kollektion"}),e.jsx("option",{value:"product",children:"Einzelprodukt"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-secondary flex-1",children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:r||!t.trim(),className:"btn-primary flex-1",children:r?e.jsx(k,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Erstellen"]})})]})]})]})]})}function ae({onCreateClick:s}){return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-violet-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(C,{className:"w-8 h-8 text-violet-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Keine Kampagnen vorhanden"}),e.jsx("p",{className:"text-zinc-400 mb-6 max-w-md mx-auto",children:"Erstelle deine erste Pinterest Kampagne, um deine Produkte zu bewerben und mehr Verkaeufe zu generieren."}),e.jsxs("button",{onClick:s,className:"btn-primary",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Erste Kampagne erstellen"]})]})}function ne(){return e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-500/20 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(W,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"Pinterest nicht verbunden"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Verbinde dein Pinterest Business Konto in den Einstellungen, um Kampagnen zu erstellen und zu verwalten."}),e.jsx(M,{to:"/settings",className:"inline-block mt-3 text-sm text-amber-400 hover:text-amber-300",children:"Zu den Einstellungen â†’"})]})]})})}function pe(){const{shops:s,isLoading:a}=Q(),{isConnected:n,isLoading:r}=U(),{addToast:t}=q(),c=s[0]?.id??null,[x,d]=g.useState(!1),[i,u]=g.useState("all"),{campaigns:h,stats:p,isLoading:b,createCampaign:o,isCreating:l,updateStatus:f,isUpdatingStatus:F,deleteCampaign:P,refetch:_}=ee(c),T=a||b||r,N=i==="all"?h:h.filter(m=>m.status===i),L=m=>{o(m,{onSuccess:()=>{t("Kampagne erstellt","success"),d(!1)},onError:()=>{t("Fehler beim Erstellen","error")}})},R=(m,w)=>{f({campaignId:m,status:w},{onSuccess:()=>{t(`Kampagne ${w==="ACTIVE"?"aktiviert":w==="PAUSED"?"pausiert":"archiviert"}`,"success")},onError:()=>{t("Fehler beim Aktualisieren","error")}})},$=m=>{P(m,{onSuccess:()=>{t("Kampagne geloescht","success")},onError:()=>{t("Fehler beim Loeschen","error")}})};return T?e.jsx(E,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(k,{className:"w-8 h-8 text-violet-500 animate-spin"})})}):e.jsx(E,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6 text-violet-400"}),"Kampagnen"]}),e.jsx("p",{className:"text-zinc-400 mt-1",children:"Verwalte deine Pinterest Werbekampagnen"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>_(),className:"btn-secondary",title:"Aktualisieren",children:e.jsx(B,{className:"w-4 h-4"})}),n&&e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Neue Kampagne"]})]})]}),!n&&e.jsx(ne,{}),n&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(y,{title:"Kampagnen",value:p.total_campaigns,icon:e.jsx(C,{className:"w-4 h-4"}),color:"violet"}),e.jsx(y,{title:"Aktiv",value:p.active_campaigns,icon:e.jsx(K,{className:"w-4 h-4"}),color:"emerald"}),e.jsx(y,{title:"Ausgaben",value:`${p.total_spend.toFixed(2)} EUR`,icon:e.jsx(D,{className:"w-4 h-4"}),color:"amber"}),e.jsx(y,{title:"Avg. ROAS",value:`${p.avg_roas.toFixed(2)}x`,icon:e.jsx(O,{className:"w-4 h-4"}),color:"violet"})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"w-4 h-4 text-zinc-500"}),e.jsxs("select",{value:i,onChange:m=>u(m.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"Alle Status"}),e.jsx("option",{value:"ACTIVE",children:"Aktiv"}),e.jsx("option",{value:"PAUSED",children:"Pausiert"}),e.jsx("option",{value:"DRAFT",children:"Entwurf"}),e.jsx("option",{value:"ARCHIVED",children:"Archiviert"})]}),e.jsxs("span",{className:"text-sm text-zinc-500",children:[N.length," Kampagne",N.length!==1?"n":""]})]}),h.length===0?e.jsx(ae,{onCreateClick:()=>d(!0)}):N.length===0?e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-8 text-center",children:e.jsx("p",{className:"text-zinc-400",children:"Keine Kampagnen mit diesem Status gefunden."})}):e.jsx("div",{className:"grid gap-4",children:N.map(m=>e.jsx(se,{campaign:m,onStatusChange:R,onDelete:$,isUpdating:F},m.id))})]}),e.jsx(te,{isOpen:x,onClose:()=>d(!1),onCreate:L,isCreating:l})]})})}export{pe as default};
//# sourceMappingURL=DashboardCampaigns-Cvw3Dzom.js.map

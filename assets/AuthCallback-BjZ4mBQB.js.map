{"version":3,"file":"AuthCallback-BjZ4mBQB.js","sources":["../../src/pages/AuthCallback.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { useNavigate, useSearchParams } from 'react-router-dom'\nimport { supabase } from '@src/lib/supabase'\nimport { useToastStore } from '@src/lib/store'\nimport { Loader2, CheckCircle, XCircle } from 'lucide-react'\n\n// =====================================================\n// AUTH CALLBACK PAGE\n// =====================================================\n\ntype CallbackStatus = 'loading' | 'success' | 'error'\n\nexport default function AuthCallback() {\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const addToast = useToastStore((state) => state.addToast)\n\n  const [status, setStatus] = useState<CallbackStatus>('loading')\n  const [message, setMessage] = useState<string>('Authentifizierung wird verarbeitet...')\n\n  useEffect(() => {\n    const handleAuthCallback = async () => {\n      try {\n        // Get the auth code from URL\n        const code = searchParams.get('code')\n        const error = searchParams.get('error')\n        const errorDescription = searchParams.get('error_description')\n\n        // Handle OAuth error\n        if (error) {\n          setStatus('error')\n          setMessage(errorDescription || 'Authentifizierung fehlgeschlagen')\n          addToast({\n            type: 'error',\n            title: 'Authentifizierung fehlgeschlagen',\n            description: errorDescription || error,\n          })\n          return\n        }\n\n        // No code present\n        if (!code) {\n          setStatus('error')\n          setMessage('Kein Authentifizierungscode gefunden')\n          return\n        }\n\n        // Exchange code for session\n        const { error: exchangeError } =\n          await supabase.auth.exchangeCodeForSession(code)\n\n        if (exchangeError) {\n          setStatus('error')\n          setMessage(exchangeError.message)\n          addToast({\n            type: 'error',\n            title: 'Authentifizierung fehlgeschlagen',\n            description: exchangeError.message,\n          })\n          return\n        }\n\n        // Success\n        setStatus('success')\n        setMessage('Erfolgreich angemeldet!')\n\n        // Redirect after short delay\n        setTimeout(() => {\n          navigate('/dashboard', { replace: true })\n        }, 1500)\n      } catch (err) {\n        console.error('Auth callback error:', err)\n        setStatus('error')\n        setMessage('Ein unerwarteter Fehler ist aufgetreten')\n      }\n    }\n\n    handleAuthCallback()\n  }, [searchParams, navigate, addToast])\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-black\">\n      <div className=\"flex flex-col items-center gap-6 rounded-xl border border-zinc-800 bg-zinc-900 p-8 shadow-lg\">\n        {/* Status Icon */}\n        {status === 'loading' && (\n          <div className=\"rounded-full bg-violet-500/10 p-4\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-violet-500\" />\n          </div>\n        )}\n\n        {status === 'success' && (\n          <div className=\"rounded-full bg-emerald-500/10 p-4\">\n            <CheckCircle className=\"h-8 w-8 text-emerald-500\" />\n          </div>\n        )}\n\n        {status === 'error' && (\n          <div className=\"rounded-full bg-red-500/10 p-4\">\n            <XCircle className=\"h-8 w-8 text-red-500\" />\n          </div>\n        )}\n\n        {/* Message */}\n        <div className=\"text-center\">\n          <h2 className=\"text-lg font-semibold text-white\">\n            {status === 'loading' && 'Authentifizierung...'}\n            {status === 'success' && 'Erfolgreich!'}\n            {status === 'error' && 'Fehler'}\n          </h2>\n          <p className=\"mt-2 text-sm text-zinc-400\">{message}</p>\n        </div>\n\n        {/* Error action */}\n        {status === 'error' && (\n          <button\n            onClick={() => navigate('/login', { replace: true })}\n            className=\"rounded-lg bg-violet-600 px-6 py-2 text-sm font-medium text-white transition-colors hover:bg-violet-700\"\n          >\n            Zurueck zum Login\n          </button>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":["AuthCallback","navigate","useNavigate","searchParams","useSearchParams","addToast","useToastStore","state","status","setStatus","useState","message","setMessage","useEffect","code","error","errorDescription","exchangeError","supabase","err","jsxs","jsx","Loader2","CheckCircle","XCircle"],"mappings":"+RAYA,SAAwBA,GAAe,CACrC,MAAMC,EAAWC,EAAA,EACX,CAACC,CAAY,EAAIC,EAAA,EACjBC,EAAWC,EAAeC,GAAUA,EAAM,QAAQ,EAElD,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAyB,SAAS,EACxD,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAiB,uCAAuC,EAEtFG,OAAAA,EAAAA,UAAU,IAAM,EACa,SAAY,CACrC,GAAI,CAEF,MAAMC,EAAOX,EAAa,IAAI,MAAM,EAC9BY,EAAQZ,EAAa,IAAI,OAAO,EAChCa,EAAmBb,EAAa,IAAI,mBAAmB,EAG7D,GAAIY,EAAO,CACTN,EAAU,OAAO,EACjBG,EAAWI,GAAoB,kCAAkC,EACjEX,EAAS,CACP,KAAM,QACN,MAAO,mCACP,YAAaW,GAAoBD,CAAA,CAClC,EACD,MACF,CAGA,GAAI,CAACD,EAAM,CACTL,EAAU,OAAO,EACjBG,EAAW,sCAAsC,EACjD,MACF,CAGA,KAAM,CAAE,MAAOK,CAAA,EACb,MAAMC,EAAS,KAAK,uBAAuBJ,CAAI,EAEjD,GAAIG,EAAe,CACjBR,EAAU,OAAO,EACjBG,EAAWK,EAAc,OAAO,EAChCZ,EAAS,CACP,KAAM,QACN,MAAO,mCACP,YAAaY,EAAc,OAAA,CAC5B,EACD,MACF,CAGAR,EAAU,SAAS,EACnBG,EAAW,yBAAyB,EAGpC,WAAW,IAAM,CACfX,EAAS,aAAc,CAAE,QAAS,EAAA,CAAM,CAC1C,EAAG,IAAI,CACT,OAASkB,EAAK,CACZ,QAAQ,MAAM,uBAAwBA,CAAG,EACzCV,EAAU,OAAO,EACjBG,EAAW,yCAAyC,CACtD,CACF,GAEA,CACF,EAAG,CAACT,EAAcF,EAAUI,CAAQ,CAAC,QAGlC,MAAA,CAAI,UAAU,yDACb,SAAAe,EAAAA,KAAC,MAAA,CAAI,UAAU,+FAEZ,SAAA,CAAAZ,IAAW,iBACT,MAAA,CAAI,UAAU,oCACb,SAAAa,EAAAA,IAACC,EAAA,CAAQ,UAAU,sCAAA,CAAuC,CAAA,CAC5D,EAGDd,IAAW,WACVa,EAAAA,IAAC,MAAA,CAAI,UAAU,qCACb,SAAAA,EAAAA,IAACE,EAAA,CAAY,UAAU,0BAAA,CAA2B,CAAA,CACpD,EAGDf,IAAW,SACVa,EAAAA,IAAC,MAAA,CAAI,UAAU,iCACb,SAAAA,EAAAA,IAACG,EAAA,CAAQ,UAAU,sBAAA,CAAuB,CAAA,CAC5C,EAIFJ,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,mCACX,SAAA,CAAAZ,IAAW,WAAa,uBACxBA,IAAW,WAAa,eACxBA,IAAW,SAAW,QAAA,EACzB,EACAa,EAAAA,IAAC,IAAA,CAAE,UAAU,6BAA8B,SAAAV,CAAA,CAAQ,CAAA,EACrD,EAGCH,IAAW,SACVa,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMpB,EAAS,SAAU,CAAE,QAAS,GAAM,EACnD,UAAU,0GACX,SAAA,mBAAA,CAAA,CAED,CAAA,CAEJ,CAAA,CACF,CAEJ"}
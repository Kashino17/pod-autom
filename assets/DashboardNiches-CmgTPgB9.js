import{j as e,b as Q,u as R,c as w}from"./vendor-query-CpRdniug.js";import{b as G,u as V,a as q}from"./index-CupJPaFk.js";import{r as b,L as D}from"./vendor-react-4xEIaAEA.js";import{u as H,a as I}from"./useShopify-BNCwXObD.js";import{D as L}from"./DashboardLayout-BZDTWsk4.js";import{L as y,G as z,J as f,r as E,A as _,n as W,X as Y,S as B,K as J,N as X,O as Z,Q as ee,s as se,t as te,b as ie,w as ae}from"./vendor-ui-BMWb517o.js";import{a as j}from"./api-DNziMqA2.js";import"./vendor-supabase-DejIJ_qE.js";import"./vendor-charts-Cz_1NfFu.js";const ne=[{name:"Fitness & Sport",icon:"ðŸ’ª"},{name:"Haustiere",icon:"ðŸ•"},{name:"Gaming",icon:"ðŸŽ®"},{name:"Musik",icon:"ðŸŽµ"},{name:"Reisen",icon:"âœˆï¸"},{name:"Kochen",icon:"ðŸ‘¨â€ðŸ³"},{name:"Fotografie",icon:"ðŸ“·"},{name:"Yoga",icon:"ðŸ§˜"}];function re({niche:s,onToggle:p,onDelete:r}){const[l,o]=b.useState(!1),m=d=>new Intl.NumberFormat("de-DE").format(d),c=d=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(d);return e.jsxs("div",{className:`relative bg-zinc-800/50 rounded-xl border transition-all ${s.isActive?"border-violet-500/30 hover:border-violet-500/50":"border-zinc-700 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-zinc-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${s.isActive?"bg-violet-500/20":"bg-zinc-700"}`,children:e.jsx(z,{className:`w-5 h-5 ${s.isActive?"text-violet-400":"text-zinc-500"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:s.name}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.isActive?"Aktiv":"Pausiert"," Â· ",s.productCount," Produkte"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>o(!l),className:"p-1.5 rounded-lg hover:bg-zinc-700 text-zinc-400 hover:text-white transition-colors",children:e.jsx(J,{className:"w-4 h-4"})}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 w-40 bg-zinc-800 border border-zinc-700 rounded-lg shadow-xl z-20 overflow-hidden",children:[e.jsx("button",{onClick:()=>{p(!s.isActive),o(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-zinc-300 hover:bg-zinc-700 transition-colors",children:s.isActive?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4"}),"Pausieren"]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),"Aktivieren"]})}),e.jsxs("button",{onClick:()=>{r(),o(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-zinc-700 transition-colors",children:[e.jsx(ee,{className:"w-4 h-4"}),"LÃ¶schen"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 divide-x divide-zinc-700/50",children:[e.jsxs("div",{className:"p-3 text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 text-zinc-400 mb-1",children:e.jsx(se,{className:"w-3.5 h-3.5"})}),e.jsx("p",{className:"text-sm font-medium text-white",children:m(s.impressions)}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Impressionen"})]}),e.jsxs("div",{className:"p-3 text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 text-zinc-400 mb-1",children:e.jsx(te,{className:"w-3.5 h-3.5"})}),e.jsx("p",{className:"text-sm font-medium text-white",children:s.sales}),e.jsx("p",{className:"text-xs text-zinc-500",children:"VerkÃ¤ufe"})]}),e.jsxs("div",{className:"p-3 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[s.trend==="up"&&e.jsx(ie,{className:"w-3.5 h-3.5 text-emerald-400"}),s.trend==="down"&&e.jsx(ae,{className:"w-3.5 h-3.5 text-red-400"}),s.trend==="neutral"&&e.jsx("div",{className:"w-3.5 h-0.5 bg-zinc-600 rounded"})]}),e.jsx("p",{className:"text-sm font-medium text-white",children:c(s.revenue)}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Umsatz"})]})]})]})}function ce({niches:s,isLoading:p,onAddNiche:r,onToggleNiche:l,onDeleteNiche:o,isAdding:m=!1}){const[c,d]=b.useState(""),[u,N]=b.useState(""),[t,a]=b.useState(!1),{maxNiches:n,tier:h,isActive:P}=G(),S=s.filter(i=>i.name.toLowerCase().includes(c.toLowerCase())),T=s.filter(i=>i.isActive).length,$=s.reduce((i,x)=>i+x.productCount,0),M=s.reduce((i,x)=>i+x.revenue,0),g=n===1/0,U=P&&(g||s.length<n),v=!g&&s.length>=n,C=!g&&s.length>=n*.8,A=i=>{!i.trim()||s.some(K=>K.name.toLowerCase()===i.toLowerCase())||(r(i.trim()),N(""),a(!1))},O=i=>{i.preventDefault(),A(u)},k=ne.filter(i=>!s.some(x=>x.name.toLowerCase()===i.name.toLowerCase()));return p?e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6",children:e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx(y,{className:"w-8 h-8 text-violet-500 animate-spin"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-violet-400"}),"Nischen",!g&&e.jsxs("span",{className:`text-sm font-normal px-2 py-0.5 rounded-full ${v?"bg-red-500/20 text-red-400":C?"bg-amber-500/20 text-amber-400":"bg-zinc-700 text-zinc-400"}`,children:[s.length,"/",n]})]}),e.jsxs("p",{className:"text-sm text-zinc-400 mt-1",children:[T," aktiv Â· ",$," Produkte Â· ",new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(M)," Umsatz"]})]}),U?e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Nische hinzufÃ¼gen"]}):v?e.jsxs(D,{to:`/checkout?tier=${h==="basis"?"premium":"vip"}`,className:"btn-primary",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Upgrade fuer mehr Nischen"]}):e.jsxs("button",{disabled:!0,className:"btn-secondary opacity-50 cursor-not-allowed",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Nische hinzufÃ¼gen"]})]}),v&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/30 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-200 font-medium",children:"Nischen-Limit erreicht"}),e.jsxs("p",{className:"text-sm text-amber-300/70",children:["Upgrade auf ",h==="basis"?"Premium":"VIP"," fuer ",h==="basis"?"15":"unbegrenzte"," Nischen."]})]})]}),e.jsxs(D,{to:`/checkout?tier=${h==="basis"?"premium":"vip"}`,className:"flex items-center gap-1 text-amber-400 hover:text-amber-300 text-sm font-medium transition-colors",children:["Upgraden",e.jsx(_,{className:"w-4 h-4"})]})]})}),s.length>4&&e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),e.jsx("input",{type:"text",value:c,onChange:i=>d(i.target.value),className:"input pl-10",placeholder:"Nischen durchsuchen..."})]}),S.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(i=>e.jsx(re,{niche:i,onToggle:x=>l(i.id,x),onDelete:()=>o(i.id)},i.id))}):e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(z,{className:"w-8 h-8 text-zinc-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:c?"Keine Nischen gefunden":"Keine Nischen vorhanden"}),e.jsx("p",{className:"text-zinc-400 mb-4",children:c?"Versuche einen anderen Suchbegriff.":"FÃ¼ge deine erste Nische hinzu, um loszulegen."}),!c&&e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Erste Nische hinzufÃ¼gen"]})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative w-full max-w-md bg-zinc-900 border border-zinc-800 rounded-2xl p-6 shadow-xl",children:[e.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 right-4 text-zinc-400 hover:text-white",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Nische hinzufÃ¼gen"}),e.jsxs("p",{className:"text-sm text-zinc-400 mt-1",children:["WÃ¤hle eine Nische fÃ¼r die Produkt-Erstellung.",!g&&e.jsxs("span",{className:`ml-2 ${C?"text-amber-400":""}`,children:["(",s.length,"/",n," verwendet)"]})]})]}),e.jsxs("form",{onSubmit:O,className:"mb-6",children:[e.jsx("label",{className:"label",children:"Eigene Nische"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:u,onChange:i=>N(i.target.value),className:"input flex-1",placeholder:"z.B. Wandern, Camping, ..."}),e.jsx("button",{type:"submit",disabled:!u.trim()||m,className:"btn-primary px-4",children:m?e.jsx(y,{className:"w-5 h-5 animate-spin"}):e.jsx(f,{className:"w-5 h-5"})})]})]}),k.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"label flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"VorschlÃ¤ge"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.slice(0,6).map(i=>e.jsxs("button",{onClick:()=>A(i.name),disabled:m,className:"flex items-center gap-2 p-3 rounded-lg bg-zinc-800 hover:bg-zinc-700 text-zinc-300 hover:text-white text-sm transition-colors text-left",children:[e.jsx("span",{className:"text-lg",children:i.icon}),e.jsx("span",{children:i.name})]},i.name))})]})]})]})]})}function F(){return[{id:"1",name:"Fitness & Sport",slug:"fitness-sport",isActive:!0,productCount:15,impressions:12450,sales:23,revenue:689.77,trend:"up",createdAt:new Date(Date.now()-720*60*60*1e3).toISOString()},{id:"2",name:"Yoga & Meditation",slug:"yoga-meditation",isActive:!0,productCount:12,impressions:8920,sales:18,revenue:539.82,trend:"up",createdAt:new Date(Date.now()-600*60*60*1e3).toISOString()},{id:"3",name:"Gaming",slug:"gaming",isActive:!0,productCount:8,impressions:5670,sales:9,revenue:269.91,trend:"neutral",createdAt:new Date(Date.now()-480*60*60*1e3).toISOString()},{id:"4",name:"Kaffee Liebhaber",slug:"kaffee-liebhaber",isActive:!0,productCount:6,impressions:3240,sales:5,revenue:149.95,trend:"down",createdAt:new Date(Date.now()-360*60*60*1e3).toISOString()},{id:"5",name:"Haustiere",slug:"haustiere",isActive:!1,productCount:4,impressions:1890,sales:2,revenue:59.98,trend:"down",createdAt:new Date(Date.now()-14400*60*1e3).toISOString()}]}function le(s){const{session:p}=V(),r=q(t=>t.addToast),l=Q(),{data:o,isLoading:m,error:c}=R({queryKey:["niche-stats",s],queryFn:async()=>{if(!s)return F();try{return(await j.get(`/api/pod-autom/niches/${s}/stats`)).niches}catch{return F()}},enabled:!!p,staleTime:1e3*60*5}),d=w({mutationFn:async t=>{if(!s)return{id:Date.now().toString(),name:t,slug:t.toLowerCase().replace(/\s+/g,"-"),isActive:!0,productCount:0,impressions:0,sales:0,revenue:0,trend:"neutral",createdAt:new Date().toISOString()};const a=await j.post(`/api/pod-autom/niches/${s}`,{niche_name:t});if(!a.success)throw new Error(a.error||"Failed to add niche");return a.niche},onSuccess:t=>{l.setQueryData(["niche-stats",s],a=>[...a||[],t]),r({type:"success",title:"Nische hinzugefÃ¼gt",description:`${t.name} wurde erfolgreich erstellt.`})},onError:t=>{r({type:"error",title:"Fehler",description:t.message})}}),u=w({mutationFn:async({id:t,active:a})=>{if(!s)return{id:t,active:a};const n=await j.put(`/api/pod-autom/niches/${s}/${t}`,{is_active:a});if(!n.success)throw new Error(n.error||"Failed to update niche");return{id:t,active:a}},onSuccess:({id:t,active:a})=>{l.setQueryData(["niche-stats",s],n=>n?.map(h=>h.id===t?{...h,isActive:a}:h)||[]),r({type:"success",title:a?"Nische aktiviert":"Nische pausiert"})},onError:t=>{r({type:"error",title:"Fehler",description:t.message})}}),N=w({mutationFn:async t=>{if(!s)return t;const a=await j.delete(`/api/pod-autom/niches/${s}/${t}`);if(!a.success)throw new Error(a.error||"Failed to delete niche");return t},onSuccess:t=>{l.setQueryData(["niche-stats",s],a=>a?.filter(n=>n.id!==t)||[]),r({type:"success",title:"Nische gelÃ¶scht"})},onError:t=>{r({type:"error",title:"Fehler",description:t.message})}});return{niches:o||[],isLoading:m,error:c,addNiche:d.mutate,isAdding:d.isPending,toggleNiche:(t,a)=>u.mutate({id:t,active:a}),isToggling:u.isPending,deleteNiche:N.mutate,isDeleting:N.isPending}}function fe(){const{shops:s,isLoading:p}=H(),r=s[0]?.id||null,{settings:l,isLoading:o}=I(r),{niches:m,isLoading:c,addNiche:d,isAdding:u,toggleNiche:N,deleteNiche:t}=le(l?.id||null),a=p||o||c;return a?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(y,{className:"w-8 h-8 text-violet-500 animate-spin"})})}):e.jsx(L,{children:e.jsx(ce,{niches:m,isLoading:a,onAddNiche:d,onToggleNiche:N,onDeleteNiche:t,isAdding:u})})}export{fe as default};
//# sourceMappingURL=DashboardNiches-CmgTPgB9.js.map

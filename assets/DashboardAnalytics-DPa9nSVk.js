import{u as f,j as e}from"./vendor-query-CpRdniug.js";import{r as d,L}from"./vendor-react-4xEIaAEA.js";import{b as T}from"./index-BNM9HcXn.js";import{u as A}from"./useShopify-Bi_TIP8F.js";import{D as v}from"./DashboardLayout-C89MhE5p.js";import{a as j}from"./api-BF1n4RIP.js";import{L as u,e as D,R as F,m as N,s as R,t as E,D as $,d as O,a5 as V,r as K,b as q,w as U,A as G}from"./vendor-ui-BMWb517o.js";import{R as y,A as Q,C as B,X as W,Y as M,T as w,a as g,P as X,b as Y,d as H}from"./vendor-charts-Cz_1NfFu.js";import"./vendor-supabase-DejIJ_qE.js";function J(n,a="30d"){const l=f({queryKey:["analytics","overview",n,a],queryFn:()=>j.get(`/api/pod-autom/analytics/${n}/overview?period=${a}`),enabled:!!n,staleTime:3e5}),r=f({queryKey:["analytics","timeseries",n,a],queryFn:()=>j.get(`/api/pod-autom/analytics/${n}/timeseries?period=${a}`),enabled:!!n,staleTime:1e3*60*5}),s=f({queryKey:["analytics","top-products",n],queryFn:()=>j.get(`/api/pod-autom/analytics/${n}/top-products?limit=10`),enabled:!!n,staleTime:1e3*60*5}),t=f({queryKey:["analytics","niche-breakdown",n],queryFn:()=>j.get(`/api/pod-autom/analytics/${n}/niche-breakdown`),enabled:!!n,staleTime:1e3*60*5}),i={total_products:0,total_views:0,total_sales:0,total_revenue:0,conversion_rate:0,winner_rate:0},c={created:0,start_phase:0,post_phase:0,winners:0,losers:0,archived:0},o={total_spend:0,total_impressions:0,total_clicks:0,total_conversions:0,campaign_revenue:0};return{overview:l.data?.overview??i,funnel:l.data?.funnel??c,campaigns:l.data?.campaigns??o,roas:l.data?.roas??0,nichePerformance:l.data?.niche_performance??[],timeSeriesData:r.data?.data??[],topProducts:s.data?.products??[],nicheBreakdown:t.data?.niches??[],isLoading:l.isLoading||r.isLoading||s.isLoading||t.isLoading,isLoadingOverview:l.isLoading,isLoadingTimeSeries:r.isLoading,isLoadingTopProducts:s.isLoading,isLoadingNiches:t.isLoading,error:l.error??r.error??s.error??t.error,refetchOverview:l.refetch,refetchTimeSeries:r.refetch,refetchTopProducts:s.refetch,refetchNiches:t.refetch,refetchAll:()=>{l.refetch(),r.refetch(),s.refetch(),t.refetch()}}}const Z=d.memo(function({value:a,onChange:l}){const r=[{value:"7d",label:"7 Tage"},{value:"30d",label:"30 Tage"},{value:"90d",label:"90 Tage"}];return e.jsx("div",{className:"flex bg-zinc-800 rounded-lg p-1",children:r.map(s=>e.jsx("button",{onClick:()=>l(s.value),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${a===s.value?"bg-violet-500 text-white":"text-zinc-400 hover:text-white"}`,children:s.label},s.value))})}),x=d.memo(function({title:a,value:l,icon:r,change:s,color:t="violet"}){const i={violet:"bg-violet-500/20 text-violet-400",emerald:"bg-emerald-500/20 text-emerald-400",amber:"bg-amber-500/20 text-amber-400",red:"bg-red-500/20 text-red-400",cyan:"bg-cyan-500/20 text-cyan-400"};return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-zinc-400",children:a}),e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${i[t]}`,children:r})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:l}),s!==void 0&&e.jsxs("span",{className:`flex items-center text-sm ${s>=0?"text-emerald-400":"text-red-400"}`,children:[s>=0?e.jsx(q,{className:"w-3 h-3 mr-1"}):e.jsx(U,{className:"w-3 h-3 mr-1"}),Math.abs(s).toFixed(1),"%"]})]})]})}),I=d.memo(function({data:a,isLoading:l}){if(l)return e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6 h-80 flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-violet-400 animate-spin"})});const r=[{key:"created",label:"Erstellt",value:a.created,color:"#6366f1"},{key:"start_phase",label:"Start Phase",value:a.start_phase,color:"#8b5cf6"},{key:"post_phase",label:"Post Phase",value:a.post_phase,color:"#a855f7"},{key:"winners",label:"Winner",value:a.winners,color:"#10b981"}],s=Math.max(...r.map(t=>t.value),1);return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-6",children:"Produkt-Funnel"}),e.jsx("div",{className:"space-y-4",children:r.map((t,i)=>{const c=t.value/s*100,o=r[i+1],m=o&&t.value>0?(o.value/t.value*100).toFixed(1):null;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-zinc-400",children:t.label}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.value})]}),e.jsx("div",{className:"h-8 bg-zinc-800 rounded-lg overflow-hidden",children:e.jsx("div",{className:"h-full rounded-lg transition-all duration-500",style:{width:`${c}%`,backgroundColor:t.color}})}),m&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-zinc-500",children:[e.jsx(G,{className:"w-3 h-3"}),m,"% Conversion"]})]},t.key)})}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-zinc-800 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:a.winners}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Winner"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-400",children:a.losers}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Loser"})]})]})]})}),ee=d.memo(function({data:a,isLoading:l}){if(l)return e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6 h-80 flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-violet-400 animate-spin"})});const r=s=>new Date(s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"});return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Aktivitaet"}),e.jsx("div",{className:"h-64",children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(Q,{data:a,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorProducts",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorSales",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(B,{strokeDasharray:"3 3",stroke:"#27272a"}),e.jsx(W,{dataKey:"date",tickFormatter:r,stroke:"#71717a",fontSize:12}),e.jsx(M,{stroke:"#71717a",fontSize:12}),e.jsx(w,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px"},labelStyle:{color:"#fff"},formatter:(s,t)=>[s,{products_created:"Erstellt",products_published:"Veroeffentlicht",sales:"Verkaeufe"}[t]||t],labelFormatter:s=>r(s)}),e.jsx(g,{type:"monotone",dataKey:"products_created",stroke:"#8b5cf6",fillOpacity:1,fill:"url(#colorProducts)"}),e.jsx(g,{type:"monotone",dataKey:"sales",stroke:"#10b981",fillOpacity:1,fill:"url(#colorSales)"})]})})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-violet-500"}),e.jsx("span",{className:"text-sm text-zinc-400",children:"Produkte erstellt"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-sm text-zinc-400",children:"Verkaeufe"})]})]})]})}),se=d.memo(function({products:a,isLoading:l}){if(l)return e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6 h-80 flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-violet-400 animate-spin"})});const r=s=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(s);return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Top Produkte"}),a.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-500",children:"Noch keine Produkte mit Verkaeufen"}):e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((s,t)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-zinc-800/50",children:[e.jsxs("span",{className:"text-lg font-bold text-zinc-600 w-6",children:["#",t+1]}),e.jsx("div",{className:"w-10 h-10 rounded bg-zinc-700 flex-shrink-0 overflow-hidden",children:s.generated_image_url?e.jsx("img",{src:s.generated_image_url,alt:s.title,loading:"lazy",decoding:"async",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-zinc-500"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-white truncate",children:s.title}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.total_sales," Verkaeufe | ",s.total_views," Views"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm font-medium text-emerald-400",children:r(s.total_revenue)})})]},s.id))})]})}),te=d.memo(function({niches:a,isLoading:l}){if(l)return e.jsx("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6 h-80 flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-violet-400 animate-spin"})});const r=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899"],s=a.slice(0,6).map(i=>({name:i.name,value:i.total_revenue})),t=i=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(i);return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Nischen Performance"}),a.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-500",children:"Noch keine Nischen konfiguriert"}):e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-48 h-48",children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(X,{children:[e.jsx(Y,{data:s,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,paddingAngle:2,dataKey:"value",children:s.map((i,c)=>e.jsx(H,{fill:r[c%r.length]},`cell-${c}`))}),e.jsx(w,{contentStyle:{backgroundColor:"#18181b",border:"1px solid #27272a",borderRadius:"8px"},formatter:i=>t(i)})]})})}),e.jsx("div",{className:"flex-1 space-y-2",children:a.slice(0,5).map((i,c)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r[c%r.length]}}),e.jsx("span",{className:"text-sm text-zinc-300",children:i.name})]}),e.jsx("span",{className:"text-sm text-zinc-400",children:t(i.total_revenue)})]},i.id))})]})]})}),ae=d.memo(function(){return e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-violet-500/30 p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-violet-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-violet-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Premium Feature"}),e.jsx("p",{className:"text-zinc-400 mb-6 max-w-md mx-auto",children:"Advanced Analytics ist nur im Premium- und VIP-Tarif verfuegbar. Upgrade jetzt fuer detaillierte Einblicke in deine Performance."}),e.jsx(L,{to:"/pricing",className:"btn-primary",children:"Auf Premium upgraden"})]})});function he(){const{shops:n,isLoading:a}=A(),{canUseFeature:l}=T(),r=n[0]?.id??null,[s,t]=d.useState("30d"),{overview:i,funnel:c,campaigns:o,roas:m,timeSeriesData:z,topProducts:k,nicheBreakdown:_,isLoading:h,refetchAll:C}=J(r,s),p=l("advancedAnalytics"),P=a||h,b=S=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(S);return P&&!i.total_products?e.jsx(v,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(u,{className:"w-8 h-8 text-violet-500 animate-spin"})})}):e.jsx(v,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6 text-violet-400"}),"Analytics"]}),e.jsx("p",{className:"text-zinc-400 mt-1",children:"Detaillierte Einblicke in deine Shop-Performance"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>C(),className:"btn-secondary",title:"Aktualisieren",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(Z,{value:s,onChange:t})]})]}),!p&&e.jsx(ae,{}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(x,{title:"Produkte",value:i.total_products,icon:e.jsx(N,{className:"w-4 h-4"}),color:"violet"}),e.jsx(x,{title:"Views",value:i.total_views.toLocaleString("de-DE"),icon:e.jsx(R,{className:"w-4 h-4"}),color:"cyan"}),e.jsx(x,{title:"Verkaeufe",value:i.total_sales,icon:e.jsx(E,{className:"w-4 h-4"}),color:"emerald"}),e.jsx(x,{title:"Umsatz",value:b(i.total_revenue),icon:e.jsx($,{className:"w-4 h-4"}),color:"amber"}),e.jsx(x,{title:"Conv. Rate",value:`${i.conversion_rate}%`,icon:e.jsx(O,{className:"w-4 h-4"}),color:"violet"}),e.jsx(x,{title:"Winner Rate",value:`${i.winner_rate}%`,icon:e.jsx(V,{className:"w-4 h-4"}),color:"emerald"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Ad Spend"}),e.jsx("p",{className:"text-xl font-bold text-white",children:b(o.total_spend)})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Impressionen"}),e.jsx("p",{className:"text-xl font-bold text-white",children:o.total_impressions.toLocaleString("de-DE")})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Klicks"}),e.jsx("p",{className:"text-xl font-bold text-white",children:o.total_clicks.toLocaleString("de-DE")})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Conversions"}),e.jsx("p",{className:"text-xl font-bold text-white",children:o.total_conversions})]}),e.jsxs("div",{className:"bg-zinc-900 rounded-xl border border-zinc-800 p-4 text-center",children:[e.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"ROAS"}),e.jsxs("p",{className:`text-xl font-bold ${m>=1?"text-emerald-400":"text-red-400"}`,children:[m.toFixed(2),"x"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(I,{data:c,isLoading:h}),e.jsx(ee,{data:z,isLoading:h})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(se,{products:k,isLoading:h}),e.jsx(te,{niches:_,isLoading:h})]})]})]})})}export{he as default};
//# sourceMappingURL=DashboardAnalytics-DPa9nSVk.js.map

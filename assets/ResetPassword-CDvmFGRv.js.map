{"version":3,"file":"ResetPassword-CDvmFGRv.js","sources":["../../src/pages/ResetPassword.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { useNavigate, Link } from 'react-router-dom'\nimport { useAuth } from '@src/contexts/AuthContext'\nimport { useToastStore } from '@src/lib/store'\nimport { validatePassword } from '@src/utils/validation'\nimport { supabase } from '@src/lib/supabase'\nimport { Lock, Eye, EyeOff, CheckCircle, Loader2 } from 'lucide-react'\n\n// =====================================================\n// RESET PASSWORD PAGE\n// =====================================================\n\nexport default function ResetPassword() {\n  const navigate = useNavigate()\n  const { updatePassword } = useAuth()\n  const addToast = useToastStore((state) => state.addToast)\n\n  // Form state\n  const [password, setPassword] = useState('')\n  const [confirmPassword, setConfirmPassword] = useState('')\n  const [showPassword, setShowPassword] = useState(false)\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [success, setSuccess] = useState(false)\n  const [isValidSession, setIsValidSession] = useState<boolean | null>(null)\n\n  // Password validation\n  const passwordValidation = validatePassword(password)\n  const passwordsMatch = password === confirmPassword\n  const canSubmit =\n    passwordValidation.isValid &&\n    passwordsMatch &&\n    confirmPassword.length > 0 &&\n    !loading\n\n  // Check if we have a valid recovery session\n  useEffect(() => {\n    const checkSession = async () => {\n      const {\n        data: { session },\n      } = await supabase.auth.getSession()\n\n      // Check if this is a recovery session\n      // The session will exist after clicking the password reset link\n      setIsValidSession(!!session)\n\n      if (!session) {\n        addToast({\n          type: 'error',\n          title: 'Ungueltiger Link',\n          description:\n            'Der Link ist abgelaufen oder ungueltig. Bitte fordere einen neuen an.',\n        })\n      }\n    }\n\n    checkSession()\n  }, [addToast])\n\n  // Handle form submit\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!canSubmit) return\n\n    setLoading(true)\n\n    const result = await updatePassword(password)\n\n    if (result.success) {\n      setSuccess(true)\n      addToast({\n        type: 'success',\n        title: 'Passwort aktualisiert',\n        description: 'Dein Passwort wurde erfolgreich geaendert.',\n      })\n\n      // Redirect after delay\n      setTimeout(() => {\n        navigate('/dashboard', { replace: true })\n      }, 2000)\n    } else {\n      addToast({\n        type: 'error',\n        title: 'Fehler',\n        description: result.message || 'Passwort konnte nicht aktualisiert werden.',\n      })\n    }\n\n    setLoading(false)\n  }\n\n  // Loading state while checking session\n  if (isValidSession === null) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-black\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-violet-500\" />\n      </div>\n    )\n  }\n\n  // Invalid session state\n  if (!isValidSession) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-black p-4\">\n        <div className=\"w-full max-w-md rounded-xl border border-zinc-800 bg-zinc-900 p-8 text-center\">\n          <div className=\"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-red-500/10\">\n            <Lock className=\"h-8 w-8 text-red-500\" />\n          </div>\n\n          <h1 className=\"mb-2 text-2xl font-bold text-white\">\n            Link ungueltig\n          </h1>\n\n          <p className=\"mb-6 text-zinc-400\">\n            Der Passwort-Reset-Link ist abgelaufen oder ungueltig. Bitte fordere\n            einen neuen Link an.\n          </p>\n\n          <Link\n            to=\"/forgot-password\"\n            className=\"inline-block rounded-lg bg-violet-600 px-6 py-3 font-medium text-white transition-colors hover:bg-violet-700\"\n          >\n            Neuen Link anfordern\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  // Success state\n  if (success) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-black p-4\">\n        <div className=\"w-full max-w-md rounded-xl border border-zinc-800 bg-zinc-900 p-8 text-center\">\n          <div className=\"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-emerald-500/10\">\n            <CheckCircle className=\"h-8 w-8 text-emerald-500\" />\n          </div>\n\n          <h1 className=\"mb-2 text-2xl font-bold text-white\">\n            Passwort geaendert!\n          </h1>\n\n          <p className=\"mb-6 text-zinc-400\">\n            Dein Passwort wurde erfolgreich aktualisiert. Du wirst in Kuerze\n            weitergeleitet...\n          </p>\n\n          <Loader2 className=\"mx-auto h-6 w-6 animate-spin text-violet-500\" />\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-black p-4\">\n      <div className=\"w-full max-w-md\">\n        {/* Header */}\n        <div className=\"mb-8 text-center\">\n          <div className=\"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-violet-500/10\">\n            <Lock className=\"h-8 w-8 text-violet-500\" />\n          </div>\n\n          <h1 className=\"text-2xl font-bold text-white\">\n            Neues Passwort setzen\n          </h1>\n          <p className=\"mt-2 text-zinc-400\">\n            Waehle ein sicheres Passwort fuer dein Konto.\n          </p>\n        </div>\n\n        {/* Form */}\n        <form\n          onSubmit={handleSubmit}\n          className=\"rounded-xl border border-zinc-800 bg-zinc-900 p-6\"\n        >\n          {/* Password field */}\n          <div className=\"mb-4\">\n            <label\n              htmlFor=\"password\"\n              className=\"mb-2 block text-sm font-medium text-zinc-300\"\n            >\n              Neues Passwort\n            </label>\n            <div className=\"relative\">\n              <input\n                id=\"password\"\n                type={showPassword ? 'text' : 'password'}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                className=\"w-full rounded-lg border border-zinc-700 bg-zinc-800 px-4 py-3 pr-12 text-white placeholder-zinc-500 focus:border-violet-500 focus:outline-none focus:ring-1 focus:ring-violet-500\"\n                placeholder=\"Mindestens 8 Zeichen\"\n                required\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-white\"\n              >\n                {showPassword ? (\n                  <EyeOff className=\"h-5 w-5\" />\n                ) : (\n                  <Eye className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n\n            {/* Password strength indicator */}\n            {password.length > 0 && (\n              <div className=\"mt-2 space-y-1\">\n                <div className=\"flex gap-1\">\n                  {[1, 2, 3, 4].map((level) => (\n                    <div\n                      key={level}\n                      className={`h-1 flex-1 rounded-full ${\n                        passwordValidation.strength >= level\n                          ? passwordValidation.strength === 1\n                            ? 'bg-red-500'\n                            : passwordValidation.strength === 2\n                              ? 'bg-amber-500'\n                              : passwordValidation.strength === 3\n                                ? 'bg-emerald-500'\n                                : 'bg-emerald-500'\n                          : 'bg-zinc-700'\n                      }`}\n                    />\n                  ))}\n                </div>\n                <p className=\"text-xs text-zinc-400\">\n                  {passwordValidation.feedback}\n                </p>\n              </div>\n            )}\n          </div>\n\n          {/* Confirm password field */}\n          <div className=\"mb-6\">\n            <label\n              htmlFor=\"confirmPassword\"\n              className=\"mb-2 block text-sm font-medium text-zinc-300\"\n            >\n              Passwort bestaetigen\n            </label>\n            <div className=\"relative\">\n              <input\n                id=\"confirmPassword\"\n                type={showConfirmPassword ? 'text' : 'password'}\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                className={`w-full rounded-lg border bg-zinc-800 px-4 py-3 pr-12 text-white placeholder-zinc-500 focus:outline-none focus:ring-1 ${\n                  confirmPassword.length > 0 && !passwordsMatch\n                    ? 'border-red-500 focus:border-red-500 focus:ring-red-500'\n                    : 'border-zinc-700 focus:border-violet-500 focus:ring-violet-500'\n                }`}\n                placeholder=\"Passwort wiederholen\"\n                required\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-white\"\n              >\n                {showConfirmPassword ? (\n                  <EyeOff className=\"h-5 w-5\" />\n                ) : (\n                  <Eye className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n            {confirmPassword.length > 0 && !passwordsMatch && (\n              <p className=\"mt-1 text-xs text-red-500\">\n                Passwoerter stimmen nicht ueberein\n              </p>\n            )}\n          </div>\n\n          {/* Submit button */}\n          <button\n            type=\"submit\"\n            disabled={!canSubmit}\n            className=\"w-full rounded-lg bg-violet-600 py-3 font-medium text-white transition-colors hover:bg-violet-700 disabled:cursor-not-allowed disabled:opacity-50\"\n          >\n            {loading ? (\n              <Loader2 className=\"mx-auto h-5 w-5 animate-spin\" />\n            ) : (\n              'Passwort speichern'\n            )}\n          </button>\n        </form>\n      </div>\n    </div>\n  )\n}\n"],"names":["ResetPassword","navigate","useNavigate","updatePassword","useAuth","addToast","useToastStore","state","password","setPassword","useState","confirmPassword","setConfirmPassword","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","loading","setLoading","success","setSuccess","isValidSession","setIsValidSession","passwordValidation","validatePassword","passwordsMatch","canSubmit","useEffect","session","supabase","handleSubmit","e","result","jsx","Loader2","jsxs","CheckCircle","Lock","EyeOff","Eye","level","Link"],"mappings":"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"}